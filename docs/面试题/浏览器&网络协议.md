# 浏览器&网络协议

## 浏览器

- 跨域方案
    - JSONP（只能 get）
    - 跨域资源共享 （CORS `Access-Control-Allow-Origin`。如果需要带 cookie 前后端都要设置
    - nginx 反向代理接口跨域
    - Postmessage 
    - Domain
    
- 跨域，为什么会有 options 请求
    - 预检请求，获知服务器是否允许跨域
    - 简单请求：get、post、head。仅仅包含 `accept`、`content-language` 等，`content-type` 只限三个值
    - 复杂请求：put、delete 。不仅包含上述头信息，`content-type='application/json'` 等超出限制
    
- 如何避免 options 请求
  
  - 服务端带上 Access-Control-Max-Age 来缓存 options 请求
  - 后端响应头部设置 `Access-Control-Max-Age` 缓存起来
  
- 事件循环

    - 微任务优先宏任务执行

    - 宏任务：script、setTimeout、setInterval 由宿主发起的

        微任务：Promise、process.nextTick 由 JS 引擎发起的

    - JavaScript 引擎等待宿主环境分配宏观任务，通常等待的行为都是一个事件循环

    - 每次执行过程，其实就是一个宏观任务，所以**宏观任务的列队**就相当于事件循环

    - 每个宏观任务又包含一个微观任务列队

- 缓存
    - 强缓存：优先级 `Expires` http1.0  <  `Cache-control` http1.1
    - 协商缓存：`Last-Modified` 本地文件最后修改日期 < `ETag` 文件指纹
    - 策略：
        - 不需要缓存：`Cache-control: no-store`
        - 频繁变动资源：`Cache-control: no-store` 配合 `ETag` 。资源被缓存，但是每次都会发送请求询问是否更新
        - 使用 `Cache-Control: max-age=31536000` 配合策略缓存使用，然后对文件进行指纹处理。一旦变动立即下载。

- 浏览器解析过程
  
    - 解析 html dom 树 =>  解析 css dom 树 => 合成 render 树 => 布局render树 => 绘制render树
    
- 回流重绘？怎么优化？



- Fetch 和 ajax 有什么区别
    - 

## 网络协议

- http 、https 区别
    - https 在 TLS 协议进行了加密。使用对称加密和非对称加密。
    - TLS 握手阶段使用非对称加密，正式传输两端使用对称加密。
- TCP  和 UDP 的区别
- Tcp 三次握手做了什么

