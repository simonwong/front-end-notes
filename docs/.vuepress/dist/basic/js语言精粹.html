<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js语言精粹笔记 | 王思杰的前端笔记</title>
    <meta name="description" content="王思杰的前端笔记，日常总结，工具使用，分享记录，框架使用等等">
    
    
    <link rel="preload" href="/front-end-notes/assets/css/0.styles.96e44ba9.css" as="style"><link rel="preload" href="/front-end-notes/assets/js/app.3a1339e1.js" as="script"><link rel="preload" href="/front-end-notes/assets/js/2.604cf4ca.js" as="script"><link rel="preload" href="/front-end-notes/assets/js/14.bac0bd5b.js" as="script"><link rel="prefetch" href="/front-end-notes/assets/js/10.03eb2c7f.js"><link rel="prefetch" href="/front-end-notes/assets/js/11.acf72346.js"><link rel="prefetch" href="/front-end-notes/assets/js/12.7c18359f.js"><link rel="prefetch" href="/front-end-notes/assets/js/13.9dd4d041.js"><link rel="prefetch" href="/front-end-notes/assets/js/15.457a46ed.js"><link rel="prefetch" href="/front-end-notes/assets/js/16.1d56c2b0.js"><link rel="prefetch" href="/front-end-notes/assets/js/17.de1efe78.js"><link rel="prefetch" href="/front-end-notes/assets/js/18.abda3408.js"><link rel="prefetch" href="/front-end-notes/assets/js/19.1db77ba3.js"><link rel="prefetch" href="/front-end-notes/assets/js/20.382a3d90.js"><link rel="prefetch" href="/front-end-notes/assets/js/21.44ab7c6c.js"><link rel="prefetch" href="/front-end-notes/assets/js/22.58bf1cb8.js"><link rel="prefetch" href="/front-end-notes/assets/js/23.225cfce7.js"><link rel="prefetch" href="/front-end-notes/assets/js/24.58fb8fa9.js"><link rel="prefetch" href="/front-end-notes/assets/js/25.2976424c.js"><link rel="prefetch" href="/front-end-notes/assets/js/26.e6ff6c2a.js"><link rel="prefetch" href="/front-end-notes/assets/js/27.915c0f24.js"><link rel="prefetch" href="/front-end-notes/assets/js/28.4f847ca0.js"><link rel="prefetch" href="/front-end-notes/assets/js/29.b505dbb6.js"><link rel="prefetch" href="/front-end-notes/assets/js/3.eb6fb99f.js"><link rel="prefetch" href="/front-end-notes/assets/js/30.0a8ccf8f.js"><link rel="prefetch" href="/front-end-notes/assets/js/31.f01e9c4b.js"><link rel="prefetch" href="/front-end-notes/assets/js/32.44fedcdf.js"><link rel="prefetch" href="/front-end-notes/assets/js/33.a7d203fc.js"><link rel="prefetch" href="/front-end-notes/assets/js/34.1109f4e6.js"><link rel="prefetch" href="/front-end-notes/assets/js/35.a38c4eee.js"><link rel="prefetch" href="/front-end-notes/assets/js/36.a1a1e8d3.js"><link rel="prefetch" href="/front-end-notes/assets/js/37.0dad6966.js"><link rel="prefetch" href="/front-end-notes/assets/js/38.bfa110f4.js"><link rel="prefetch" href="/front-end-notes/assets/js/39.64a2e766.js"><link rel="prefetch" href="/front-end-notes/assets/js/4.25b99976.js"><link rel="prefetch" href="/front-end-notes/assets/js/40.ea450882.js"><link rel="prefetch" href="/front-end-notes/assets/js/41.2095a3be.js"><link rel="prefetch" href="/front-end-notes/assets/js/42.942e5393.js"><link rel="prefetch" href="/front-end-notes/assets/js/43.aa111a7b.js"><link rel="prefetch" href="/front-end-notes/assets/js/44.90c1960f.js"><link rel="prefetch" href="/front-end-notes/assets/js/45.a769dbc5.js"><link rel="prefetch" href="/front-end-notes/assets/js/46.96b52737.js"><link rel="prefetch" href="/front-end-notes/assets/js/47.eae4a707.js"><link rel="prefetch" href="/front-end-notes/assets/js/48.441a1808.js"><link rel="prefetch" href="/front-end-notes/assets/js/49.562478a7.js"><link rel="prefetch" href="/front-end-notes/assets/js/5.0ad5b366.js"><link rel="prefetch" href="/front-end-notes/assets/js/6.472d5017.js"><link rel="prefetch" href="/front-end-notes/assets/js/7.0fdb16c3.js"><link rel="prefetch" href="/front-end-notes/assets/js/8.5a63fe57.js"><link rel="prefetch" href="/front-end-notes/assets/js/9.11d9bbfc.js">
    <link rel="stylesheet" href="/front-end-notes/assets/css/0.styles.96e44ba9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-end-notes/" class="home-link router-link-active"><!----> <span class="site-name">王思杰的前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end-notes/note/" class="nav-link">日常</a></li><li class="dropdown-item"><!----> <a href="/front-end-notes/重学前端/" class="nav-link">重学前端</a></li></ul></div></div><div class="nav-item"><a href="/front-end-notes/basic/" class="nav-link router-link-active">前端基础</a></div><div class="nav-item"><a href="/front-end-notes/engineering/" class="nav-link">前端工程</a></div><div class="nav-item"><a href="/front-end-notes/backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/front-end-notes/computerbasic/" class="nav-link">计算机基础</a></div><div class="nav-item"><a href="https://github.com/simonjayw" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end-notes/note/" class="nav-link">日常</a></li><li class="dropdown-item"><!----> <a href="/front-end-notes/重学前端/" class="nav-link">重学前端</a></li></ul></div></div><div class="nav-item"><a href="/front-end-notes/basic/" class="nav-link router-link-active">前端基础</a></div><div class="nav-item"><a href="/front-end-notes/engineering/" class="nav-link">前端工程</a></div><div class="nav-item"><a href="/front-end-notes/backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/front-end-notes/computerbasic/" class="nav-link">计算机基础</a></div><div class="nav-item"><a href="https://github.com/simonjayw" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/front-end-notes/basic/基础算法.html" class="sidebar-link">JS基础算法</a></li><li><a href="/front-end-notes/basic/js语言精粹.html" class="active sidebar-link">js语言精粹笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#语法" class="sidebar-link">语法</a></li><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#对象" class="sidebar-link">对象</a></li><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#函数" class="sidebar-link">函数</a></li><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#继承" class="sidebar-link">继承</a></li><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#数组" class="sidebar-link">数组</a></li><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#正则表达式" class="sidebar-link">正则表达式</a></li><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#方法" class="sidebar-link">方法</a></li><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#毒瘤" class="sidebar-link">毒瘤</a></li><li class="sidebar-sub-header"><a href="/front-end-notes/basic/js语言精粹.html#糟粕" class="sidebar-link">糟粕</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js语言精粹笔记"><a href="#js语言精粹笔记" aria-hidden="true" class="header-anchor">#</a> js语言精粹笔记</h1> <hr> <h2 id="语法"><a href="#语法" aria-hidden="true" class="header-anchor">#</a> 语法</h2> <h3 id="语句"><a href="#语句" aria-hidden="true" class="header-anchor">#</a> 语句</h3> <ul><li>for in 遍历对象属性</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span>item <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="对象"><a href="#对象" aria-hidden="true" class="header-anchor">#</a> 对象</h2> <h3 id="更新"><a href="#更新" aria-hidden="true" class="header-anchor">#</a> 更新</h3> <div class="language-js extra-class"><pre class="language-js"><code>stooge<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Jerome'</span><span class="token punctuation">;</span>
<span class="token comment">// 如果已经存在，替换</span>
<span class="token comment">// 没有就扩充到对象中</span>
</code></pre></div><h3 id="引用"><a href="#引用" aria-hidden="true" class="header-anchor">#</a> 引用</h3> <blockquote><p>对象通过引用来传递。他们永远不会复制</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> x <span class="token operator">=</span> stooge<span class="token punctuation">;</span>
x<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Curly'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> nick <span class="token operator">=</span> stooge<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// 'Curly'</span>
<span class="token comment">// x 和 stooge 指向同一个对象的引用</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 引用不同的空对象</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> b <span class="token operator">=</span> c <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 引用同一个空对象</span>
</code></pre></div><h3 id="原型"><a href="#原型" aria-hidden="true" class="header-anchor">#</a> 原型</h3> <blockquote><p>所有对象字面量创建的对象都连接到<code>Object.prototype</code></p></blockquote> <p>创建一个使用原对象使用其原型的新对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>beget <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function-variable function">create</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> another_stooge <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>stooge<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="反射"><a href="#反射" aria-hidden="true" class="header-anchor">#</a> 反射</h3> <blockquote><p>原型链中的任何属性都会有产生值</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> flight<span class="token punctuation">.</span>toString <span class="token comment">// 'function'</span>
<span class="token keyword">typeof</span> flight<span class="token punctuation">.</span>constructor <span class="token comment">// 'function'</span>
</code></pre></div><h3 id="枚举"><a href="#枚举" aria-hidden="true" class="header-anchor">#</a> 枚举</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>name <span class="token keyword">in</span> another_stooge<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> another_stooge<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="删除"><a href="#删除" aria-hidden="true" class="header-anchor">#</a> 删除</h3> <p>delete运算符可以来删除对象的属性。不会触及原型链中的任何对象</p> <h3 id="减少全局变量"><a href="#减少全局变量" aria-hidden="true" class="header-anchor">#</a> 减少全局变量</h3> <p>最小化使用全局变量，只创建一个唯一的全局变量</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token constant">MYAPP</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token constant">MYAPP</span><span class="token punctuation">.</span>stoog <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="函数"><a href="#函数" aria-hidden="true" class="header-anchor">#</a> 函数</h2> <h3 id="调用模式及this指向"><a href="#调用模式及this指向" aria-hidden="true" class="header-anchor">#</a> 调用模式及this指向</h3> <ul><li>方法调用模式</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token function-variable function">increment</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>函数调用模式</li></ul> <blockquote><p>以这种模式调用函数，this绑定到全局对象</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>解决方法:增加一个方法，并给this赋值</p> <div class="language-js extra-class"><pre class="language-js"><code>myObject<span class="token punctuation">.</span><span class="token function-variable function">double</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 赋值</span>

    <span class="token keyword">var</span> <span class="token function-variable function">helper</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        that<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">,</span> that<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">helper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 以函数形式调用</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
myObject<span class="token punctuation">.</span><span class="token function">double</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 以方法的现实调用</span>
</code></pre></div><ul><li>构造器调用模式</li></ul> <blockquote><p>如果在一个函数前带上new调用，背地里会创建一个连接到该函数的prototype成员的新对象，同时this会绑定到新对象上</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建构造器函数式。一个带有status属性的对象</span>
<span class="token keyword">var</span> <span class="token function-variable function">Quo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 给Quo的所有实例提供公用方法</span>
<span class="token class-name">Quo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get_status</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 构造一个Quo实例</span>
<span class="token keyword">var</span> myQuo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Quo</span><span class="token punctuation">(</span><span class="token string">&quot;confused&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myQuo<span class="token punctuation">.</span><span class="token function">get_status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;confused&quot;</span>
</code></pre></div><ul><li>Apply调用模式</li></ul> <blockquote><p>apply方法让我们构建一个参数数组传递给调用函数。
参数1：绑定给this的值。参数2：参数数组</p></blockquote> <h3 id="参数"><a href="#参数" aria-hidden="true" class="header-anchor">#</a> 参数</h3> <blockquote><p>arguments数组。拥有length属性，但没有数组方法</p></blockquote> <h3 id="返回"><a href="#返回" aria-hidden="true" class="header-anchor">#</a> 返回</h3> <blockquote><p>一个函数总是会返回一个值。如果没有指定返回值，则返回undefined
如果加了new,则返回this(该新对象)</p></blockquote> <h3 id="作用域"><a href="#作用域" aria-hidden="true" class="header-anchor">#</a> 作用域</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>
        <span class="token comment">// a:3, b:7, c: 11</span>
        a <span class="token operator">+=</span> b <span class="token operator">+</span> c
        <span class="token comment">// a:21, b:7, c: 11</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// a: 3, b:5, c未定义</span>
    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// a:21, b:5</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="闭包"><a href="#闭包" aria-hidden="true" class="header-anchor">#</a> 闭包</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 糟糕的例子。再循环中创建函数</span>
<span class="token keyword">var</span> <span class="token function-variable function">add_the_handlers</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">nodes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nodes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
        nodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onlick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 改良后</span>
<span class="token keyword">var</span> <span class="token function-variable function">add_the_handlers</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">nodes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token function-variable function">helper</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nodes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token function">helper</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="回调"><a href="#回调" aria-hidden="true" class="header-anchor">#</a> 回调</h3> <h3 id="模块"><a href="#模块" aria-hidden="true" class="header-anchor">#</a> 模块</h3> <h3 id="级联"><a href="#级联" aria-hidden="true" class="header-anchor">#</a> 级联</h3> <blockquote><p>如果我们让这些方法返回this而不是undefined，就可以启动级联</p></blockquote> <h3 id="记忆"><a href="#记忆" aria-hidden="true" class="header-anchor">#</a> 记忆</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">memoizer</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">memo<span class="token punctuation">,</span> formula</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token function-variable function">recur</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> result <span class="token operator">=</span> memo<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> result <span class="token operator">!==</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token function">formula</span> <span class="token punctuation">(</span>recur<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            memo<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> recur<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// fibonacci函数</span>
<span class="token keyword">var</span> fibonacci <span class="token operator">=</span> <span class="token function">memoizer</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">recur<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">recur</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">recur</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 阶乘</span>
<span class="token keyword">var</span> factorial <span class="token operator">=</span> <span class="token function">memoizer</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">recur<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token function">recur</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="继承"><a href="#继承" aria-hidden="true" class="header-anchor">#</a> 继承</h2> <h3 id="伪类"><a href="#伪类" aria-hidden="true" class="header-anchor">#</a> 伪类</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.定义构造器并扩充原型</span>
<span class="token keyword">var</span> <span class="token function-variable function">Mammal</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Mammal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get_name</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Mammal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">says</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>saying <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 2.构造一个实例</span>
<span class="token keyword">var</span> myMammal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mammal</span><span class="token punctuation">(</span><span class="token string">'Herb the Mammal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> myMammal<span class="token punctuation">.</span><span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 构造一个伪类继承Mammal</span>
<span class="token keyword">var</span> <span class="token function-variable function">Cat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>saying <span class="token operator">=</span> <span class="token string">'meow'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 替换Cat.prototype为一个新的Mammal实例</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mammal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 扩充</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">purr</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i<span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            s <span class="token operator">+=</span> <span class="token string">'-'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        s <span class="token operator">+=</span> <span class="token string">'r'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get_name</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">says</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">says</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> myCat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token string">'Henrietta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myCat<span class="token punctuation">.</span><span class="token function">says</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myCat<span class="token punctuation">.</span><span class="token function">purr</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myCat<span class="token punctuation">.</span><span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Function<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token string">'inherits'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Parent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="原型-2"><a href="#原型-2" aria-hidden="true" class="header-anchor">#</a> 原型</h3> <blockquote><p>用对象字面量构建对象
这是一种“差异化继承”</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myMammal <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'Herb the Mammal'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get_name</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">says</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>saying <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>beget <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function-variable function">create</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> myCat <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>myMammal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// var Cat = function () {};</span>
<span class="token comment">// Cat.prototype = myMammal;</span>
<span class="token comment">// var myCat = new Cat();</span>

myCat<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Henrietta'</span><span class="token punctuation">;</span>
myCat<span class="token punctuation">.</span>saying <span class="token operator">=</span> <span class="token string">'meow'</span><span class="token punctuation">;</span>
myCat<span class="token punctuation">.</span><span class="token function-variable function">purr</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i<span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            s <span class="token operator">+=</span> <span class="token string">'-'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        s <span class="token operator">+=</span> <span class="token string">'r'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
myCat<span class="token punctuation">.</span><span class="token function-variable function">get_name</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">says</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">says</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myCat<span class="token punctuation">.</span><span class="token function">says</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myCat<span class="token punctuation">.</span><span class="token function">purr</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myCat<span class="token punctuation">.</span><span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="函数化"><a href="#函数化" aria-hidden="true" class="header-anchor">#</a> 函数化</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">constructor</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">spec<span class="token punctuation">,</span> my</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> that<span class="token punctuation">,</span>其他私有变量<span class="token punctuation">;</span>
    my <span class="token operator">=</span> my <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    把共享的变量和函数添加到my中

    that <span class="token operator">=</span> 一个新对象

    添加给that的特权方法

    <span class="token keyword">return</span> that<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="部件"><a href="#部件" aria-hidden="true" class="header-anchor">#</a> 部件</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">eventuality</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">that</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> registry <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    that<span class="token punctuation">.</span><span class="token function-variable function">fire</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> array<span class="token punctuation">,</span>
            func<span class="token punctuation">,</span>
            handler<span class="token punctuation">,</span>
            i<span class="token punctuation">,</span>
            type <span class="token operator">=</span> <span class="token keyword">typeof</span> event <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">?</span> event <span class="token punctuation">:</span> event<span class="token punctuation">.</span>type<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>registry<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            array <span class="token operator">=</span> registry<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                handler <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

                func <span class="token operator">=</span> handler<span class="token punctuation">.</span>method<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> func <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    func <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>func<span class="token punctuation">]</span>
                <span class="token punctuation">}</span>

                <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> handler<span class="token punctuation">.</span>parameters <span class="token operator">||</span> <span class="token punctuation">[</span>event<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    that<span class="token punctuation">.</span><span class="token function-variable function">on</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> method<span class="token punctuation">,</span> parameters</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
            method<span class="token punctuation">:</span> method<span class="token punctuation">,</span>
            parameters<span class="token punctuation">:</span> parameters
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>registry<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            registry<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            registry<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>handler<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> that<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="数组"><a href="#数组" aria-hidden="true" class="header-anchor">#</a> 数组</h2> <h3 id="判断数组"><a href="#判断数组" aria-hidden="true" class="header-anchor">#</a> 判断数组</h3> <blockquote><p>js对于数组和对象的区别是混乱的。typeof运算符报告数组的类型是'object'</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 判断数组</span>
<span class="token keyword">var</span> <span class="token function-variable function">is_array</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[Object Array]'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="正则表达式"><a href="#正则表达式" aria-hidden="true" class="header-anchor">#</a> 正则表达式</h2> <h3 id="例子-匹配url"><a href="#例子-匹配url" aria-hidden="true" class="header-anchor">#</a> 例子--匹配URL</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> parse_url <span class="token operator">=</span> <span class="token regex">/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;http://www.ora.com:80/goodparts?q#fragment&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> parse_url<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token string">'scheme'</span><span class="token punctuation">,</span> <span class="token string">'slash'</span><span class="token punctuation">,</span> <span class="token string">'host'</span><span class="token punctuation">,</span> <span class="token string">'port'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">,</span> <span class="token string">'query'</span><span class="token punctuation">,</span> <span class="token string">'hash'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> blanks <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> i<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> names<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>names<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> blanks<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">,</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="结构"><a href="#结构" aria-hidden="true" class="header-anchor">#</a> 结构</h3> <table><thead><tr><th>标志</th> <th>含义</th></tr></thead> <tbody><tr><td>g</td> <td>全局的（匹配多次）</td></tr> <tr><td>i</td> <td>忽略大小写</td></tr> <tr><td>m</td> <td>多行</td></tr></tbody></table> <table><thead><tr><th style="text-align:center;">标识</th> <th style="text-align:left;">含义</th></tr></thead> <tbody><tr><td style="text-align:center;">\d</td> <td style="text-align:left;">数字0-9</td></tr> <tr><td style="text-align:center;">\D</td> <td style="text-align:left;">非\d</td></tr> <tr><td style="text-align:center;">\w</td> <td style="text-align:left;">数字0-9/a=z/A-z/下划线</td></tr> <tr><td style="text-align:center;">\W</td> <td style="text-align:left;">非\w</td></tr> <tr><td style="text-align:center;">\s</td> <td style="text-align:left;">空格符，tab，换页，换行</td></tr> <tr><td style="text-align:center;">\S</td> <td style="text-align:left;">非\s</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:center;">[...]</td> <td style="text-align:left;">字符范围[a-zA-Z]</td></tr> <tr><td style="text-align:center;">...</td> <td style="text-align:left;">除...外的</td></tr> <tr><td style="text-align:center;">^...$</td> <td style="text-align:left;">^首......尾$</td></tr> <tr><td style="text-align:center;">(...)</td> <td style="text-align:left;">捕获型分组。任何匹配这个分组的都会被捕获</td></tr> <tr><td style="text-align:center;">(?:...)</td> <td style="text-align:left;">非捕获型分组。这个分组是可选的</td></tr> <tr><td style="text-align:center;">(...)?</td> <td style="text-align:left;">? 标识匹配0次或1次</td></tr> <tr><td style="text-align:center;"></td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:center;">x*</td> <td style="text-align:left;">贪恋。匹配&gt;=0次</td></tr> <tr><td style="text-align:center;">x+</td> <td style="text-align:left;">贪婪。匹配&gt;0次</td></tr> <tr><td style="text-align:center;">x{n}</td> <td style="text-align:left;">重复n次</td></tr> <tr><td style="text-align:center;">x{n,}</td> <td style="text-align:left;">重复&gt;=n次</td></tr> <tr><td style="text-align:center;">x{n,m}</td> <td style="text-align:left;">重复n到m次</td></tr></tbody></table> <hr> <h2 id="方法"><a href="#方法" aria-hidden="true" class="header-anchor">#</a> 方法</h2> <h3 id="array"><a href="#array" aria-hidden="true" class="header-anchor">#</a> Array</h3> <ul><li><p>array.<strong>concat</strong>(item)
浅复制</p></li> <li><p>array.<strong>join</strong>(separator)
字符串拼接</p></li> <li><p>array.<strong>pop</strong>()
移除最后一个元素；改</p></li> <li><p>array.<strong>push</strong>(item)
后面添加；改</p></li> <li><p>array.<strong>shift</strong>()
移除第一个元素；改</p></li> <li><p>array.<strong>unshift</strong>(item)
前面添加；改</p></li> <li><p>array.<strong>splice</strong>(start, deleteCount, item...)
移除1个或多个元素，新的item替换。
start为index，deleteCount个数，</p></li> <li><p>array.<strong>slice</strong>(start, end)
浅复制，start为index，0起数，end为1起数</p></li> <li><p>array.<strong>reverse</strong>()
反转顺序；改</p></li> <li><p>array.<strong>sort</strong>(comparefn)
排序
相等返回0，负数，a排前面，正数b排前面</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>n<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span> <span class="token comment">// 正序</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="function"><a href="#function" aria-hidden="true" class="header-anchor">#</a> Function</h3> <ul><li>func.<strong>apply</strong>(this.Arg, argArray)
调用function，传一个被绑定到this上的对象，和一个可选数组</li></ul> <h3 id="number"><a href="#number" aria-hidden="true" class="header-anchor">#</a> Number</h3> <ul><li><p>num.<strong>toString</strong>(radix)
转换为字符串。radix可选，控制进制数</p></li> <li><p>num.<strong>toExponential</strong>(fractionDigis)
转换为指数形式的字符串。fractionDigis可选，控制小数点后位数必须0-20</p></li> <li><p>num.<strong>toFixed</strong>(fractionDigits)
转为十进制数形式的字符串</p></li> <li><p>num.<strong>toPrecision</strong>(precision)
转为十进制数形式的字符串.precision可选。控制精度。必须0-21</p></li></ul> <h3 id="object"><a href="#object" aria-hidden="true" class="header-anchor">#</a> Object</h3> <ul><li>obj.<strong>hasOwnProperty</strong>(name)
判断是否包含name属性，不检查原型链</li></ul> <h3 id="regexp"><a href="#regexp" aria-hidden="true" class="header-anchor">#</a> RegExp</h3> <ul><li>regexp.<strong>exec</strong>(string)</li></ul> <blockquote><p>最强大（和最慢）
如果成功匹配返回数组</p></blockquote> <ul><li>regexp.<strong>test</strong>(string)</li></ul> <blockquote><p>最简单（和最快）
匹配返回true
不要对这个方法使用g标识</p></blockquote> <h3 id="string"><a href="#string" aria-hidden="true" class="header-anchor">#</a> String</h3> <ul><li><p>str.<strong>charAt</strong>(pos)
返回pos位置的字符</p></li> <li><p>str.<strong>charCodeAt</strong>(pos)
返回pos位置的字符的字符码位</p></li> <li><p>str.<strong>indexOf</strong>(searchString, position)
str中找searchString，返回位置 || -1
position可选，指定位置查找
倒着查
str.lastIndexOf(searchString, position)</p></li> <li><p>str.<strong>localeCompare</strong>(that)
比较字符串，相等返回0</p></li> <li><p>str.<strong>match</strong>(regexp)
和一个正则匹配
如果有g，那么生成一个包含所有（除捕获分组之外）的数组
没有，那就跟<code>regexp.exec(str)</code>一样</p></li> <li><p>str.<strong>replace</strong>(searchValue, replaceVaule)
查找替换，返回新字符串</p> <ul><li>searchValue是字符串，那么只替换第一次出现的地方
如果是正则并带有g，那么全部替换。</li> <li>replaceVaule是字符串，$特别含义
$$ （替换$
$&amp; （整个匹配文本
$` （匹配之前的文本
$' （匹配之后的文本
replaceVaule如果是函数，每次匹配到都会被调用，返回的字符串会用作替换文本</li></ul></li> <li><p>str.<strong>search</strong>(regexp)
只接受正则，忽略g。返回首字符位置 || -1</p></li> <li><p>str.<strong>slice</strong>(start, end)
返回对应位置的字符串
substring跟slice一样，但不能用负数，用slice代替使用它</p></li> <li><p>str.<strong>split</strong>(separator, limit)
分隔字符串</p></li> <li><p>str.<strong>toLowerCase</strong>()
转为小写</p></li> <li><p>str.<strong>toUpperCase</strong>()
转为大写</p></li> <li><p>str.<strong>fromCharCode</strong>(shar...)
根据数字编码返回一个字符串</p></li></ul> <h2 id="毒瘤"><a href="#毒瘤" aria-hidden="true" class="header-anchor">#</a> 毒瘤</h2> <ul><li><p>全局变量</p></li> <li><p>作用域</p></li></ul> <blockquote><p>最好的方式是在每个函数的开头部分声明所有变量</p></blockquote> <ul><li>自动插入分号</li></ul> <blockquote><p>尤其是return语句。必须在同一行</p></blockquote> <ul><li><p>保留字</p></li> <li><p>unicode</p></li> <li><p>typeof</p></li></ul> <blockquote><p>typeof不能辨别出null与对象</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 可以这样，因为null为假</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>my_value <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> my_value <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// my_value是一个对象或数组</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>parseInt</li></ul> <blockquote><p>字符串转换为整数的函数。
遇到非数字会停止解析。
数字前面有0也会有问题。默认8进制求值。可以加上基数为参数<code>parseInt(&quot;08&quot;, 10)</code></p></blockquote> <ul><li><ul><li></li></ul></li></ul> <blockquote><p>如果两个运算数都是数字，返回和。否则返回字符串拼接</p></blockquote> <ul><li>浮点数</li></ul> <blockquote><p>0.1 + 0.2 的不等于0.3。可以通过指定精度避免</p></blockquote> <ul><li>NaN</li></ul> <blockquote><p>使用isNaN辨别数字与NaN。如果为数字返回false，但是如果是字符串型数字，也会返回false</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 最佳办法</span>
<span class="token keyword">var</span> <span class="token function-variable function">isNumber</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">isNumber</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'number'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isFinite</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>伪数组</li></ul> <p>arguments数组不是一个数组</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>my_value<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Array]'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 确实是一个数组</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>假值</li></ul> <p><code>0</code> <code>Nan</code> <code>''</code> <code>false</code> <code>null</code> <code>undefined</code></p> <p>-hasOwnProperty</p> <blockquote><p>hasOwnProperty是一个方法，不是运算符。
可能会被一个不同函数甚至非函数的值替换</p></blockquote> <h2 id="糟粕"><a href="#糟粕" aria-hidden="true" class="header-anchor">#</a> 糟粕</h2> <ul><li>==</li></ul> <blockquote><p>建议永远不要使用<code>==</code> <code>!=</code>。始终使用<code>===</code> <code>!==</code></p></blockquote> <ul><li>with语句</li></ul> <blockquote><p>快捷访问对象属性。但是结果可能有时不可预料。避免使用它。</p></blockquote> <ul><li>eval</li></ul> <blockquote><p>减弱安全性，降低语言能力。避免使用它</p></blockquote> <ul><li>continue语句</li></ul> <blockquote><p>跳到循环的顶部。我发现一段代码<strong>移除continue</strong>后，性能得到了改善</p></blockquote> <ul><li>switch 穿越</li></ul> <blockquote><p>除非明确终端流程</p></blockquote> <ul><li>缺少块的语句</li></ul> <blockquote><p>If、while、do、for可以接受单行语句，避免使用</p></blockquote> <ul><li>++ --</li></ul> <blockquote><p>作者觉得使用++ -- 代码变得过于拥挤复杂隐晦</p></blockquote> <ul><li>位运算符</li></ul> <p>&amp; | ^ ~ &gt;&gt; &gt;&gt;&gt; &lt;&lt;</p> <ul><li>function语句对比function表达式</li></ul> <p><code>function foo () {}</code></p> <p><code>var foo = function foo () {}</code></p> <blockquote><p>function语句在解析时会发生被提升的情况
建议使用第二种形式，明确表示foo是一个包含一个函数值的变量。要理解，函数就是数值</p></blockquote> <p>一个语句不能以一个函数表达式开头。
解决办法，把函数调用在圆括号中</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>类型的包装对象</li></ul> <blockquote><p>避免使用<code>new Object</code> <code>new Array</code>。可用<code>{}</code> <code>[]</code>代替</p></blockquote> <ul><li>new</li></ul> <blockquote><p>与new结合使用的函数应该首字母大写。并且这些首字母大写的形式只用来命名构造器函数
最好不去使用new。</p></blockquote> <ul><li>void</li></ul> <blockquote><p>避免使用它</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front-end-notes/basic/基础算法.html" class="prev">JS基础算法</a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/front-end-notes/assets/js/app.3a1339e1.js" defer></script><script src="/front-end-notes/assets/js/2.604cf4ca.js" defer></script><script src="/front-end-notes/assets/js/14.bac0bd5b.js" defer></script>
  </body>
</html>
