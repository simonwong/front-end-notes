# 2021

## åäºŒæœˆ

### è€ƒè™‘ä¸€ä¸ªå—åˆ—è¡¨å¸ƒå±€

![](https://file.wangsijie.top/blog/202112281513717.png)

åœ¨ä¸€ä¸ªå¡ç‰‡ä¸­ï¼Œæœ‰ `padding: 32px`ï¼Œçº¢è‰²æ¡†å†…æ˜¯ contentã€‚è€ƒè™‘è“è‰²çš„åˆ—è¡¨å¸ƒå±€ã€‚ç»¿è‰²çº¿æ¡æ˜¯æ¯é¡¹ä¹‹é—´çš„é—´è·ã€‚

```less
@card-space: 32px;
@card-half-space: @card-space / 2;

.wrapper {
  display: flex;
  flex-wrap: wrap;
  // é€šè¿‡è´Ÿçš„é—´è·ï¼Œæ”¶å›å¤šä½™çš„é—´è·
  margin: -@card-half-space;

  .card {
    flex: 0 0 50%;

    .cardContent {
      // ä¸ºæ¯ä¸ªå†…å®¹è®¾ç½® half space çš„ margin
      margin: @card-half-space;
    }
  }
}
```





### Redux vs Recoil

![](https://file.wangsijie.top/blog/202112211428244.png)

å›¾ç‰‡å¼•ç”¨è‡ª https://blog.joshsoftware.com/2021/12/07/can-recoil-replace-redux-state-management-in-react/

### `@babel/runtime` çš„ä½¿ç”¨æ€è€ƒ

`@babel/runtime` æ˜¯ä¸€ä¸ª helper åº“ã€‚

ä»¥ `@rollup/plugin-babel`çš„ `babelHelpers?: "runtime" | "bundled" | "inline" | "external"` å±æ€§ä¸¾ä¾‹ï¼Œ

-  `runtime` ï¼Œé‚£ä¹ˆä»“åº“éœ€è¦ä¾èµ– `@babel/runtime`ï¼Œåœ¨æ‰“åŒ…åæ–‡ä»¶é¡¶éƒ¨ä¼šå†™å…¥ `import xxx from @babel/runtime/xxx`ã€‚ï¼ˆæ¨èåŒ…ä½¿ç”¨ï¼‰

-  `bundled`ï¼Œç”Ÿæˆçš„ä»£ç ä¼šç›´æ¥åŒ…å« helper ä»£ç ï¼Œä½†æ¯ä»½ helper ä»£ç åªä¼šç”Ÿæˆä¸€æ¬¡ã€‚ï¼ˆæ¨èåº”ç”¨ä½¿ç”¨ï¼‰
- `inline`ï¼Œä¼šåœ¨æ¯ä¸ªæ‰“åŒ…åçš„æ–‡ä»¶å†…é‡å¤çš„å†™å…¥ helper ä»£ç ï¼Œé€ æˆå†—ä½™ã€‚ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰
- `external`ï¼Œä»£ç å°†ä¼šç¼–è¯‘æˆ `babelHelpers["typeof"]` ï¼Œå°†ä¼šä½¿ç”¨å…¨å±€çš„ helper æ–¹æ³•ã€‚ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰

### ä¸ºä½ çš„ jsã€json æ–‡ä»¶æ·»åŠ ç±»å‹æ ¡éªŒ

[**intro-to-js-ts.**](https://www.typescriptlang.org/docs/handbook/intro-to-js-ts.html)

```js
// @ts-check
/**
 * @type {import('@remix-run/dev/config').AppConfig}
 */
module.exports = {
  
}
```

åŠ  `// @ts-check`æ˜¯ä¸ºäº†ç»™äºˆç±»å‹æŠ¥é”™æç¤ºã€‚

ä½†æ˜¯ç»è¿‡å®è·µï¼Œ`typescript@4.5.2` ä¼šç»™ç±»å‹çš„æç¤ºï¼Œä½†æ˜¯ä¸ä¼šæŠ¥é”™ï¼Œä½†å¦‚ä¸‹ï¼Œå¯¹äºå˜é‡ç”³æ˜å°±ä¼šæŠ¥é”™

```js
// @ts-check
/**
 * @type {import('@remix-run/dev/config').AppConfig}
 */
const config = {
  a: 1
}
module.exports = config
```

[**JSON Schma**](https://json-schema.org/)

å¦‚ä¸‹ï¼ŒJSON çš„å±æ€§ `$schma` å¯ä»¥å¸®åŠ©æ ¡éªŒ json çš„æœ‰æ•ˆæ€§ã€‚

```json
{
  "$schema": "https://developer.microsoft.com/json-schemas/api-extractor/v7/api-extractor.schema.json",
}
```

## åä¸€æœˆ

### æŸ¥çœ‹åŠ è½½æ¨¡å—çš„ CPU é…ç½®æ–‡ä»¶å’Œå †å†…å­˜é…ç½®æ–‡ä»¶

```shell
node --cpu-prof --heap-prof -e "require('request')"
```

ä¼šç”Ÿæˆä¸€ä¸ª`.cpuprofile`å’Œä¸€ä¸ª`.heapprofile` æ–‡ä»¶

ç„¶ååœ¨ Chrome DevTool ä¸­çš„ `Performance` å’Œ `Memory` æ ‡ç­¾ä¸­åŠ åœ¨å¯¹åº”æ–‡ä»¶



### å¦‚ä½•åœ¨ VSCode ä¸­è°ƒè¯• ts

å‚è€ƒ [typesctipt-debugging](https://code.visualstudio.com/docs/typescript/typescript-debugging)

é…ç½® `tsconfig.json` ï¼Œç¡®ä¿ `sourceMap: true` ï¼Œç¡®è®¤ `outDir`

```json
// tsconfig.json
{
  "compilerOptions": {
    "sourceMap": true,
    "outDir": "dist",
    // other config ...
  },
}
```

åœ¨ `.vscode` ä¸‹åˆ›å»º `tasks.json`

```json
// tasks.json
{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "typescript",
      "tsconfig": "tsconfig.json",
      "problemMatcher": ["$tsc"],
      "group": "build",
      "label": "tsc: build"
    },
  ]
}
```

åœ¨ `.vscode` ä¸‹åˆ›å»º `launch.json`ã€‚

```json
// launch.json
{
  "version": "0.2.0",
  "configurations": [
    {
      "type": "node",
      "request": "launch",
      "name": "Launch Program",
      "skipFiles": [
        "<node_internals>/**"
      ],
      "program": "${workspaceFolder}/src/index.ts",
      "preLaunchTask": "tsc: build",
      "outFiles": [
        // æ³¨æ„è¿™é‡Œçš„ dist æ˜¯ tsconfig.json é…ç½®çš„ outDir
        "${workspaceFolder}/dist/**/*.js"
      ]
    }
  ]
}
```





### javascript Unicode

**å†…å»ºå‡½æ•°**

- `String.charCodeAt()`

  ç»™å®šç´¢å¼•å¤„çš„ UTF-16 ä»£ç å•å…ƒ

  ï¼ˆ å¯ä»¥ç†è§£ä¸ºå°†å­—ç¬¦ä¸²è½¬æˆ unicode å†ä¼ æˆ 10 è¿›åˆ¶çš„æ•°å­—ï¼‰

- `String.fromCharCode()`

  è¿”å›ç”±æŒ‡å®šçš„ UTF-16 ä»£ç å•å…ƒåºåˆ—åˆ›å»ºçš„å­—ç¬¦ä¸²

  ï¼ˆå¯ä»¥ç†è§£ä¸ºä»£ç å•å…ƒè½¬å­—ç¬¦ä¸²ï¼‰



**è‡ªå®šä¹‰å‡½æ•°**

```js
function unicodeAt(str, index = 0) {
  let code = str.charCodeAt(index).toString(16).toUpperCase()
  while (code.length < 4) {
    code = `0${code}`
  }
  return `\\u${code}`;
}
```

```js
function toUnicode(str) {
  if (!str) {
    return ''
  }
  return Array.prototype.reduce.call(str, (pre, cur, index) => {
    return `${pre}${unicodeAt(str, index)}`
  }, '')
}
```



**å­—ç¬¦ä¸²é•¿åº¦**

```js
const drink = 'cafe\u0301';
console.log(drink);                    // => 'cafÃ©'
console.log(drink.length);             // => 5
console.log(drink.normalize())         // => 'cafÃ©'
console.log(drink.normalize().length); // => 4
```

```js
const drink = 'cafe\u0327\u0301';
console.log(drink);                    // => 'cafÈ©Ì'
console.log(drink.length);             // => 6
console.log(drink.normalize());        // => 'cafÈ©Ì'
console.log(drink.normalize().length); // => 5
```

```js
const smile = 'ğŸ˜€';
const regex = /[ğŸ˜€-ğŸ˜]/u;
const regexEscape = /[\u{1F600}-\u{1F60E}]/u;
const regexSpEscape = /[\uD83D\uDE00-\uD83D\uDE0E]/u;
console.log(regex.test(smile));         // => true
console.log(regexEscape.test(smile));   // => true
console.log(regexSpEscape.test(smile)); // => true
```



### Typescript tuple

æˆ‘å°è¯•äº†åœ¨ stack overflow ç¬¬ä¸€æ¬¡æå‡ºé—®é¢˜ï¼Œå…³äºå°†[readonly çš„æ•°ç»„ç±»å‹è½¬ä¸º ä¸€ä¸€å¯¹åº”çš„å¯¹è±¡ç±»å‹](https://stackoverflow.com/questions/69808894/how-write-a-typescript-generics-type-for-array-one-to-one-conversion-to-object) ã€‚

å¾—åˆ°äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ `infer` å’Œ recursive call æ¥å®ç°ã€‚



æ›´å¤š tuple manipulations å‚è€ƒ  [**Handle literal arrays/tuples types in TypeScript**](https://catchts.com/tuples)



## åæœˆ

### Babel  å®½æ¾æ¨¡å¼ï¼ˆloose modeï¼‰

å®½æ¾æ¨¡å¼åœ¨ babel ä¸­ä¸€èˆ¬ä¸æ¨èä½¿ç”¨ï¼š

- ä¼˜ç‚¹ï¼šç”Ÿæˆä»£ç é€Ÿåº¦æ›´å¿«ï¼Œä»£ç ç®€æ´ã€‚
- ç¼ºç‚¹ï¼šä»£ç å¯èƒ½ä¸ç¬¦åˆ ES6 æ ‡å‡†ã€‚



## ä¹æœˆ

### CSS åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä»€ä¹ˆå•ä½ï¼ˆform Josh W Comeauï¼‰

- å¯¹äºæ’ç‰ˆï¼ˆtypographyï¼‰ é€šå¸¸ä½¿ç”¨ remï¼Œæœ‰æ›´é‡è¦çš„å¯è®¿é—®æ€§ä¼˜åŠ¿
- å¯¹äºç›’æ¨¡å‹ï¼Œä½¿ç”¨åƒç´ ï¼ˆpixelsï¼‰ï¼Œæ¯” rem æ›´åŠ ç›´è§‚
- å¯¹äºå®½é«˜ï¼Œå›ºå®šå¤§å°ä½¿ç”¨å›ºå®šå€¼ï¼Œå¦‚200pxï¼Œç›¸å¯¹å¤§å°ä½¿ç”¨ç™¾åˆ†æ¯”ï¼Œå¦‚ 25%
- å¯¹äºé¢œè‰²æ›´å–œæ¬¢ hsl



### CSS åˆ†å±‚é˜´å½±ï¼ˆlayered shadowsï¼‰

åœ¨çº¿åˆ›å»ºå¹³æ»‘å‹å¥½çš„åˆ†å±‚é˜´å½± https://shadows.brumm.af/

**åŸºç¡€**

```css
/* æ™®é€šçš„ */
.box {
  box-shadow: 0 3px 3px rgba(0, 0, 0, 0.2);
}

/* åˆ›å»ºå¹³æ»‘çš„é˜´å½±ï¼Œé€æ¸çš„å¢åŠ  y-offset å’Œ blur-radius */
.box-shadow-5 {
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.12), 
              0 2px 2px rgba(0, 0, 0, 0.12), 
              0 4px 4px rgba(0, 0, 0, 0.12), 
              0 8px 8px rgba(0, 0, 0, 0.12),
              0 16px 16px rgba(0, 0, 0, 0.12);
}

/* å½“å±‚æ•°å¢åŠ ï¼Œé€æ˜åº¦ä¹Ÿåº”è¯¥éšä¹‹å¢åŠ  */
.box-shadow-6 {
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.11), 
              0 2px 2px rgba(0, 0, 0, 0.11), 
              0 4px 4px rgba(0, 0, 0, 0.11), 
              0 8px 8px rgba(0, 0, 0,0.11), 
              0 16px 16px rgba(0, 0, 0, 0.11), 
              0 32px 32px rgba(0, 0, 0, 0.11);
}
```

**é€šè¿‡é€æ¸æ§åˆ¶é€æ˜åº¦æ¥å˜å¾—å°–é”æˆ–å‘æ•£**

```css
/* å°–é”çš„ï¼Œé€æ¸å¢å¤§é€æ˜åº¦ */
.box-shadow-sharp {
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 
              0 2px 2px rgba(0, 0, 0, 0.20), 
              0 4px 4px rgba(0, 0, 0, 0.15), 
              0 8px 8px rgba(0 ,0, 0, 0.10),
              0 16px 16px rgba(0, 0, 0, 0.05);
}

/* å‘æ•£çš„ï¼Œé€æ¸å‡å°‘é€æ˜åº¦ */
.box-shadow-diffuse {
    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.08), 
                0 2px 2px rgba(0, 0, 0, 0.12), 
                0 4px 4px rgba(0, 0, 0, 0.16), 
                0 8px 8px rgba(0, 0, 0, 0.20);
}

```

**é€šè¿‡æ›´å¿«çš„å¢åŠ  blur-radius æ¥æ˜¾å¾—æ›´åŠ æŸ”å’Œï¼Œæ¢¦å¹»**

```css
.box-shadow-dreamy {
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.07), 
                0 2px 4px rgba(0, 0, 0, 0.07), 
                0 4px 8px rgba(0, 0, 0, 0.07), 
                0 8px 16px rgba(0, 0, 0, 0.07),
                0 16px 32px rgba(0, 0, 0, 0.07), 
                0 32px 64px rgba(0, 0, 0, 0.07);
}
```





### å¤šæ€ç»„ä»¶çš„ç±»å‹å®šä¹‰

```tsx
import { ComponentsPropsWithoutRef, ElemntType, ReactNode } from 'react'

type MyButtonProps<T extends ElemntType> = {
  as?: T
  children: ReactNode
}

const Button = <T extends ElemntType = 'button'>({
	as,
  children,
  ...props
}: MyButtonProps<T> &
	Omit<ComponentsPropsWithoutRef<T>, keyof MyButtonProps<T>>) => {
	const Component = as || 'button'
  
  return <Component {...props}>{children}</Component>
}

export default Button
```

### React ä¸­å‘½ä»¤å¼æ’å…¥çš„ç»„ä»¶ï¼Œcontext é—®é¢˜

å‘½ä»¤å¼æ’å…¥çš„åˆ° root çš„ç»„ä»¶ï¼Œ`ReactDOM.render` ä¼šåŠ¨æ€åˆ›å»ºæ–°çš„ React å®ä¾‹ï¼Œæ’å…¥çš„ context å’Œé¡µé¢çš„ context ä¸ç›¸åŒï¼Œæ‰€ä»¥æ— æ³•è·å–å½“å‰é¡µé¢æ ¹èŠ‚ç‚¹é…ç½®çš„ contextã€‚



## å…«æœˆ

### ç®€å•æ— è„‘çš„é»‘æš—æ¨¡å¼å®ç°

```css
@media (prefers-color-scheme: dark) {
  html {
    filter: invert(1) hue-rotate(180deg);
  }
  html img {
  	filter: invert(1) hue-rotate(180deg);
  }
}

html {
  transition: color 0.3s, background-color 0.3s;
}
```



## ä¸ƒæœˆ

### fetch abort

é€šè¿‡ [AbortController](https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController) æ¥å£ä¸­æ­¢ä¸€ä¸ªæˆ–å¤šä¸ªè¯·æ±‚

```js
const controller = new AbortController()

// ç‚¹å‡» abort æ¥å£
abortBtn.addEventListener('click', function() {
  controller.abort();
})

fetch('url', { signal: controller.signal })
  .then(response => {
  	console.log(response)
	})
	.catch(err => {
  	console.log(err) // AbortError
	})
```



**React ä¸­çš„å®è·µ**

```jsx
import React, { useRef, useEffect } from 'react'
const () => {
  const controller = useRef(new AbortController())
  
  useEffectOnce(() => {
    Promise.all([
      fetch('url1', { signal: controller.current.signal }),
      fetch('url2', { signal: controller.current.signal }),
    ]).then(() => {
      // do somthing
    })
    
    return () => {
      // åœ¨é¡µé¢å¸è½½æ—¶ï¼ˆè¯·æ±‚å¯èƒ½è¿˜åœ¨ç»§ç»­ï¼‰ï¼Œæ‰§è¡Œ abortï¼Œ
      controller.current.abort()
    }
  })
  
  return (
  	// ...
  )
}
```





### `position: fixed` å¤±æ•ˆ

çˆ¶å…ƒç´ è®¾ç½®äº†é none çš„ `transform`ï¼Œä¼šå¯¼è‡´æœ€å…ƒç´ çš„ fixed å¤±æ•ˆ

- é none çš„`transform` ä¼šåˆ›å»ºä¸€ä¸ªå †å ä¸Šä¸‹æ–‡ï¼ˆStacking Contextï¼‰å’ŒåŒ…å«å—ï¼ˆContaining Blockï¼‰
- ç”±äºå †å ä¸Šä¸‹æ–‡çš„åˆ›å»ºï¼Œè¯¥å…ƒç´ ä¼šå½±å“å…¶å­å…ƒç´ çš„å›ºå®šå®šä½ã€‚è®¾ç½®äº† `position:fixed` çš„å­å…ƒç´ å°†ä¸ä¼šåŸºäº viewport å®šä½ï¼Œè€Œæ˜¯åŸºäºè¿™ä¸ªçˆ¶å…ƒç´ 



æ›´å¤šå‚è€ƒ [CSS3 transformå¯¹æ™®é€šå…ƒç´ çš„Nå¤šæ¸²æŸ“å½±å“](https://www.zhangxinxu.com/wordpress/2015/05/css3-transform-affect/)

## å…­æœˆ

### JS çš„æ•°å€¼è¡¨ç¤ºæ–¹å¼

```js
const max = Number.MAX_VALUE
const min = Number.MIN_VALUE

const a = 35 // åè¿›åˆ¶
const b = 123e3 // ç§‘å­¦è®¡æ•°æ³•
// è¿›åˆ¶
const c = 0o377 // 0o å…«è¿›åˆ¶
const d = 0xff // 0x åå…­è¿›åˆ¶
const e = 0b11 // 0b äºŒè¿›åˆ¶

// ç‰¹æ®Šå€¼
-0 === +0 // true >>> Object.is ä¸º false
0 === -0 // true >>> Object.is ä¸º false
0 === +0 // true >>> Object.is ä¸º true

NaN === NaN // false
Object.is(NaN, NaN) // true
0 / 0 // NaN

// æ— ç©·
1 / -0 // -Infinity
-1 / -0 // Infinity

```



### React Spring Cheatsheet

![](https://file.wangsijie.top/blog/20210628141117.png)

### æµ‹è¯•ç”¨ä¾‹ **AAA** æ¨¡å¼

**AAAæ¨¡å¼**ï¼šç¼–æ’ï¼ˆArrangeï¼‰ï¼Œæ‰§è¡Œï¼ˆActï¼‰ï¼Œæ–­è¨€ï¼ˆAssertï¼‰ã€‚

```js
describe("<Input />", () => {
  it("It should keep a $ in front of the input", () => {
    // Arrange
    const utils = render(<CostInput />)
	  const input = utils.getByLabelText('cost-input')
    // Act
    fireEvent.change(input, { target: { value: '23' } })
    // Assert
    expect(input.value).toBe('$23')
  });
});
```

![](https://file.wangsijie.top/blog/202112291836064.png)

### jest mock console.log

```js
let originalLog

beforeEach(() => {
  originalLog = global.console.log
  global.console.log = jest.fn()
})

afterEach(() => {
  global.console.log = originalLog
})
```





## äº”æœˆ

### åç«¯è¿”å›å­—ç¬¦å¸¦æœ‰ `\n` çš„ css å¤„ç†

```css
div {
  white-space: pre-line;
}
```

`white-space: pre-line` 

> è¿ç»­çš„ç©ºç™½ç¬¦ä¼šè¢«åˆå¹¶ã€‚åœ¨é‡åˆ°æ¢è¡Œç¬¦æˆ–è€…[` <br />`](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/br)å…ƒç´ ï¼Œæˆ–è€…éœ€è¦ä¸ºäº†å¡«å……ã€Œè¡Œæ¡†ç›’å­([line boxes](https://www.w3.org/TR/CSS2/visuren.html#inline-formatting))ã€æ—¶ä¼šæ¢è¡Œã€‚

## å››æœˆ

### onerror è·¨åŸŸé—®é¢˜ `Script error.`

> å½“åŠ è½½è‡ª[ä¸åŒåŸŸ](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy)çš„è„šæœ¬ä¸­å‘ç”Ÿè¯­æ³•é”™è¯¯æ—¶ï¼Œä¸ºé¿å…ä¿¡æ¯æ³„éœ²ï¼ˆå‚è§[bug 363897](https://bugzilla.mozilla.org/show_bug.cgi?id=363897)ï¼‰ï¼Œè¯­æ³•é”™è¯¯çš„ç»†èŠ‚å°†ä¸ä¼šæŠ¥å‘Šï¼Œè€Œä»£ä¹‹ç®€å•çš„ `"Script error."`

**è§£å†³æ–¹æ¡ˆ**

script æ·»åŠ  `corssorigin="anonymous"`

```html
<script src="<https://xxx.com/xxx.js>" crossorigin="anonymous"></script>
```

æ­¤æ—¶éåŒåŸŸçš„èµ„æºåŠ è½½ï¼Œæµè§ˆå™¨ä¼šæŠ¥ `No 'Access-Control-Allow-Origin' header is present on the requested resource`

ç„¶åéœ€è¦é…ç½® cdn

```
Access-Control-Allow-Origin: *
```

## ä¸‰æœˆ

### Jenkins + GitHub æŒç»­é›†æˆ

1. Jenkins å®‰è£… github æ’ä»¶
2. Jenkins -> é…ç½® -> GitHub -> é«˜çº§ -> æ·»åŠ  githubservers -> æ·»åŠ ä¸€ä¸ªå‡­è¯
   - å‡­è¯åœ¨ github -> settings -> developer settings -> Personal access tokens -> å‹¾é€‰ repo å’Œ admin:repo_hook
   - å°† secret text å¤åˆ¶åˆ°å‡­è¯ (è¦é€‰æ‹© secret text)
3. github ä»“åº“ -> setting -> webhooks -> add webhook -> è¾“å…¥ url `http://[ip]:[port]/github-webhook`
4. Jenkins pipeline -> æ„å»ºè§¦å‘å™¨ -> github hook trigger for GITScm polling
5. å®Œ



### web è°ƒèµ· Appï¼ˆDeep Linking)

#### å¹³å°æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”

|      æŠ€æœ¯      | Universal Link | Android App Link |       URI Scheme        |   Chrome Intent   |
| :------------: | :------------: | :--------------: | :---------------------: | :---------------: |
|    å¹³å°è¦æ±‚    |    >= iOS 9    |   >= Android 6   |   Chrome 1 < 25, iOS    |  Chrome 1 >= 25   |
|   æœªå®‰è£…è¡¨ç°   | æ‰“å¼€ Web é¡µé¢  |  æ‰“å¼€ Web é¡µé¢   |        å‘ç”Ÿé”™è¯¯         | å¯ä»¥æ‰“å¼€ Web é¡µé¢ |
| èƒ½å¦ä¸å‘ç”Ÿè·³è½¬ |      ä¸èƒ½      |       ä¸èƒ½       |           èƒ½            |        èƒ½         |
| èƒ½å¦å»ä¸‹è½½é¡µé¢ |       èƒ½       |        èƒ½        |          ä¸èƒ½           |        èƒ½         |
|  iframe è§¦å‘   |     ä¸æ”¯æŒ     |      ä¸æ”¯æŒ      | Chrome 1 <= 18, iOS < 9 |      ä¸æ”¯æŒ       |
|    é“¾æ¥æ ¼å¼    |   æ­£å¸¸çš„ URL   |    æ­£å¸¸çš„ URL    |    è‡ªå®šä¹‰åè®®çš„ URL     | intent åè®®çš„ URL |

- **URI Scheme**

`appname://any.com/path?query=value`

æœ€åŸå§‹çš„ä¸€ç§è°ƒèµ·æ–¹å¼ã€‚

ç¼ºç‚¹ï¼šå‘½åå¯èƒ½å†²çªã€è°ƒèµ·å¤±è´¥ä¼šç›´æ¥å‘ç”Ÿé”™è¯¯ä¼šæç¤º URL æ— æ•ˆ

ä¼˜ç‚¹ï¼šé€‚ç”¨äºåœ¨ç‰¹å®šä½¿ç”¨åœºæ™¯ï¼Œå³è°ƒèµ·å¤±è´¥åä»æ—§å¯ä»¥ç»§ç»­ä½¿ç”¨å½“å‰é¡µé¢

- **Universal Link**

æœªå®‰è£…ä¼šè·³è½¬æŒ‡å®šé¡µé¢ï¼Œä¾‹å¦‚ iTunes

éœ€è¦æœåŠ¡ç«¯ç»™å‡º [`apple-app-site-association`](https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html) ä»¥éªŒè¯ App çš„ URL ç»‘å®š

- **Android App Link**

ç±»ä¼¼ universal linkï¼Œéœ€è¦æœåŠ¡ç«¯ç»™å‡º `assetlinks.json` ä»¥éªŒè¯ App çš„ URL ç»‘å®š

- **Chrome Intent**

å¦‚æœå·²å®‰è£…ï¼ŒChrome ä¼šä¸è¯¢é—®ç”¨æˆ·ç›´æ¥è°ƒèµ· Appã€‚å¦‚æœæœªå®‰è£…ï¼ŒChrome ä¼šè·³è½¬è‡³ `S.browser_fallback_url`ã€‚

```
intent:
   HOST/URI-path // Optional host 
   #Intent;
      package=[string];
      action=[string];
      category=[string];
      component=[string];
      scheme=[string];
      S.browser_fallback_url=[encoded_full_url];
   end;
```

#### å”¤èµ·æ–¹å¼

- iframe
- a æ ‡ç­¾
- window.location

#### checkOpen æ–¹æ¡ˆ

åˆ©ç”¨ `visibilityChange`ã€`pagehide` ç›‘å¬ï¼Œåˆ©ç”¨å±æ€§ `document.hidden`

```ts
let hidden: Hidden;

function getSupportedProperty(): void {
  if (typeof document.hidden !== 'undefined') {
    // Opera 12.10 and Firefox 18 and later support
    hidden = 'hidden';
    visibilityChange = 'visibilitychange';
  } else if (typeof document.msHidden !== 'undefined') {
    hidden = 'msHidden';
    visibilityChange = 'msvisibilitychange';
  } else if (typeof document.webkitHidden !== 'undefined') {
    hidden = 'webkitHidden';
    visibilityChange = 'webkitvisibilitychange';
  }
}

getSupportedProperty();

/**
 * åˆ¤æ–­é¡µé¢æ˜¯å¦éšè—ï¼ˆè¿›å…¥åå°ï¼‰
 */
function isPageHidden(): boolean {
  if (typeof hidden === 'undefined') return false;
  return document[hidden] as boolean;
}
/**
 * æ£€æµ‹æ˜¯å¦å”¤ç«¯æˆåŠŸ
 * @param cb - å”¤ç«¯å¤±è´¥å›è°ƒå‡½æ•°
 * @param timeout
 */
export function checkOpen(failure: () => void, timeout: number): void {
  const timer = setTimeout(() => {
    const pageHidden = isPageHidden();
    if (!pageHidden) {
      failure();
    }
  }, timeout);

  if (typeof visibilityChange !== 'undefined') {
    document.addEventListener(visibilityChange, () => {
      clearTimeout(timer);
    });
  } else {
    window.addEventListener('pagehide', () => {
      clearTimeout(timer);
    });
  }
}
```







## äºŒæœˆ

### Chrome è°ƒè¯•æŠ€å·§

- Elements > styles æ ‡ç­¾

  `:hov` å¯ä»¥å¼ºåˆ¶å¼€å¯å¾®ç±»

  `.cls` å¯ä»¥ä¿®æ”¹æ¿€æ´»ç¦ç”¨ç±»å

- Elements > Computed æ ‡ç­¾

  é€‰ä¸­èŠ‚ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°èŠ‚ç‚¹æœ€ç»ˆçš„ç”Ÿæ•ˆçš„æ ·å¼

- Network > Online é€‰æ‹©

  å¼±ç½‘è°ƒè¯•

#### æ§åˆ¶å°

å¸¸ç”¨æ–¹æ³•

- `copy(a)` å¯ä»¥å¿«é€Ÿå®Œæ•´çš„æ‹·è´ a çš„å€¼ï¼Œä¸è®ºæ˜¯å¤æ‚å¯¹è±¡è¿˜æ˜¯ä»€ä¹ˆ
- `document.designMode = "on"` æˆ–è€… `document.body.contentEditable="true"` å¼€å¯ç½‘é¡µå¯è§†åŒ–ç¼–è¾‘

#### Performance

#### Source

![](https://file.wangsijie.top/blog/20210225143343.webp)

**debugå·¥å…·æ **

- æš‚åœï¼ˆç»§ç»­ï¼‰

- å•æ­¥è·³è¿‡

- è¿›å…¥å‡½æ•°

- è·³å‡ºå‡½æ•°

- å•æ­¥æ‰§è¡Œ

- æ¿€æ´»ï¼ˆå…³é—­ï¼‰æ‰€æœ‰æ–­ç‚¹

- ä»£ç æ‰§è¡Œå¼‚å¸¸å¤„è‡ªåŠ¨æ–­ç‚¹

- - éœ€è¦å‹¾é€‰â€œPause On Caught Exceptionsâ€

**watch**ï¼š å˜é‡ç›‘æ§ï¼Œå¯ä»¥æ·»åŠ åˆ é™¤éœ€è¦ç›‘å¬çš„å˜é‡

**Call Stack**ï¼š å‡½æ•°è°ƒç”¨æ ˆï¼Œæ ¹æ®è°ƒç”¨æ ˆå¯ä»¥éå¸¸æ–¹ä¾¿æ£€ç´¢åˆ°é¡¹ç›®ä¸­ä½•å¤„ä¸»åŠ¨â€œé€’è¿›â€è°ƒç”¨äº†è¯¥å‡½æ•°

**Scope**ï¼š ä½œç”¨åŸŸï¼Œå½“å‰æ–­ç‚¹å‡½æ•°æ‰€æœ‰å±æ€§çš„å€¼

**Breakpoints**ï¼š æ–­ç‚¹åˆ—è¡¨

**XHR Breakpoints**ï¼š è°ƒè¯• XHR

**DOM Breakpoints**ï¼š DOM æ–­ç‚¹ï¼Œåœ¨ Elements ä¸­å³é”®é€‰æ‹© break on

**Global Breakpoints**ï¼š å…¨å±€ç›‘å¬

#### Coverage

ä»£ç ä½¿ç”¨ç‡ç»Ÿè®¡

#### Rendering

ç›‘æ§é¡µé¢é‡ç»˜é‡æ’æ—¶å˜åŒ–çš„åŒºåŸŸè¿›è¡Œé«˜äº®å¤„ç†ã€‚

#### Laters

æ˜¾ç¤ºåœ°æŸ¥çœ‹ DOM å±‚å…³ç³»

## ä¸€æœˆ

### é›¶å®½ç©ºæ ¼ï¼ˆ**zero-width space**ï¼‰

- é›¶å®½ç©ºæ ¼ï¼ˆzero-width space, ZWSPï¼‰

  ç”¨äºå¯èƒ½éœ€è¦æ¢è¡Œå¤„ã€‚
      Unicode: `U+200B`  HTML: `&#8203`;

- é›¶å®½ä¸è¿å­— (zero-width non-joinerï¼ŒZWNJ)

  æ”¾åœ¨ç”µå­æ–‡æœ¬çš„ä¸¤ä¸ªå­—ç¬¦ä¹‹é—´ï¼ŒæŠ‘åˆ¶æœ¬æ¥ä¼šå‘ç”Ÿçš„è¿å­—ï¼Œè€Œæ˜¯ä»¥è¿™ä¸¤ä¸ªå­—ç¬¦åŸæœ¬çš„å­—å½¢æ¥ç»˜åˆ¶ã€‚
      Unicode: `U+200C`  HTML: `&#8204`;

- é›¶å®½è¿å­—ï¼ˆzero-width joinerï¼ŒZWJï¼‰

  æ˜¯ä¸€ä¸ªæ§åˆ¶å­—ç¬¦ï¼Œæ”¾åœ¨æŸäº›éœ€è¦å¤æ‚æ’ç‰ˆè¯­è¨€ï¼ˆå¦‚é˜¿æ‹‰ä¼¯è¯­ã€å°åœ°è¯­ï¼‰çš„ä¸¤ä¸ªå­—ç¬¦ä¹‹é—´ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªæœ¬ä¸ä¼šå‘ç”Ÿè¿å­—çš„å­—ç¬¦äº§ç”Ÿäº†è¿å­—æ•ˆæœã€‚
      Unicode: `U+200D`  HTML: `&#8205`;

- å·¦è‡³å³ç¬¦å·ï¼ˆLeft-to-right markï¼ŒLRMï¼‰

  æ˜¯ä¸€ç§æ§åˆ¶å­—ç¬¦ï¼Œç”¨äºè®¡ç®—æœºçš„åŒå‘æ–‡ç¨¿æ’ç‰ˆä¸­ã€‚
      Unicode: `U+200E`  HTML: `&lrm; &#x200E;` æˆ– `&#8206`;

- å³è‡³å·¦ç¬¦å·ï¼ˆRight-to-left markï¼ŒRLMï¼‰

  æ˜¯ä¸€ç§æ§åˆ¶å­—ç¬¦ï¼Œç”¨äºè®¡ç®—æœºçš„åŒå‘æ–‡ç¨¿æ’ç‰ˆä¸­ã€‚
      Unicode: `U+200F`  HTML: `&rlm; &#x200F`; æˆ– `&#8207`;

- å­—èŠ‚é¡ºåºæ ‡è®°ï¼ˆbyte-order markï¼ŒBOMï¼‰

  å¸¸è¢«ç”¨æ¥å½“åšæ ‡ç¤ºæ–‡ä»¶æ˜¯ä»¥UTF-8ã€UTF-16æˆ–UTF-32ç¼–ç çš„æ ‡è®°ã€‚
      Unicode: `U+FEFF`

æŸ¥çœ‹ [Unicode å­—ç¬¦ç™¾ç§‘](https://unicode-table.com/cn/)



**è¿‡æ»¤é›¶å®½ç©ºæ ¼**

```js
str.replace(/[\u200b-\u200f\uFEFF\u202a-\u202e]/g, "");
```
