# Node åŒ…ç®¡ç†

- 2010ï¼šnpm å‘å¸ƒï¼Œæ”¯æŒ Node.jsã€‚
- 2016ï¼šyarn å‘å¸ƒã€‚å®ƒæ˜¾ç¤ºå‡ºæ¯” npm æ›´å¥½çš„æ€§èƒ½ã€‚å®ƒè¿˜ç”Ÿæˆä¸€ä¸ª`yarn.lock`æ–‡ä»¶ï¼Œä½¿ repos çš„å…±äº«å’Œç²¾ç¡®å¤åˆ¶å˜å¾—æ›´åŠ å®¹æ˜“å’Œå¯é¢„æµ‹ã€‚
- 2017ï¼šnpm 5 å‘å¸ƒã€‚å®ƒæä¾›è‡ªåŠ¨ç”Ÿæˆ`package-lock.json`æ–‡ä»¶å¯¹æ ‡ `yarn.lock`.
- 2018 å¹´ï¼šnpm 6 å‘å¸ƒï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚ç°åœ¨ npm åœ¨å®‰è£…ä¾èµ–é¡¹ä¹‹å‰æ£€æŸ¥å®‰å…¨æ¼æ´ã€‚
- 2020ï¼šYarn 2 å’Œ npm 7 å‘å¸ƒã€‚è¿™ä¸¤ä¸ªè½¯ä»¶åŒ…éƒ½å…·æœ‰å‡ºè‰²çš„æ–°åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹åé¢çœ‹åˆ°ã€‚
- 2021ï¼š[Yarn 3 å‘å¸ƒ](https://github.com/yarnpkg/berry/blob/master/CHANGELOG.md#300)å¹¶è¿›è¡Œäº†å„ç§æ”¹è¿›

## yarn vs npm

å†™äº 2022-02

### å®‰è£…åŒ…ç®¡ç†å™¨

- npm æ˜¯ Node è‡ªå¸¦çš„ï¼Œé€šè¿‡ `nvm` ç®¡ç† node ç‰ˆæœ¬æ¥é—´æ¥ç®¡ç† npm ç‰ˆæœ¬
- yarn éœ€è¦æ‰‹åŠ¨å®‰è£…ï¼Œé€šè¿‡ `yarn set version` ç®¡ç†ç‰ˆæœ¬

### å®‰è£…ä¾èµ–

- npm æ˜¯æŒ‰é¡ºåºä¸€ä¸ªä¸€ä¸ªå®‰è£…ä¾èµ–çš„ã€‚è¾“å‡ºä¿¡æ¯å¤šï¼Œéš¾ä»¥é˜…è¯»ã€‚
- yarn æ˜¯å¹¶è¡Œå®‰è£…çš„ï¼Œé€Ÿåº¦è¦æ¯” npm å¿«ã€‚è¾“å‡ºä¿¡æ¯ç®€æ´ã€‚

ä»–ä»¬éƒ½æœ‰ç¼“å­˜æœºåˆ¶ï¼Œéšç€ npm çš„è¿­ä»£ï¼Œé€Ÿåº¦å·®ä¸å¤šè·Ÿ yarn ç›¸å½“äº†ã€‚

### å®‰å…¨æ€§

npm 6 ä»¥å‰å­˜åœ¨ä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼Œ6 å¼€å§‹æé«˜äº†å®‰å…¨æ€§ï¼Œä¼šåœ¨ä¾èµ–å®‰è£…å‰æ£€æŸ¥ã€‚

ä»–ä»¬éƒ½æ˜¯ç”¨å“ˆå¸ŒåŠ å¯†ç®—æ³•æ¥ä¿è¯åŒ…çš„å®Œæ•´æ€§ã€‚



## pnpm vs yarn vs npm

å†™äº 2022-02



[pnpm åŠŸèƒ½æ¯”è¾ƒ](https://pnpm.io/zh/feature-comparison)

| åŠŸèƒ½                     | pnpm                 | Yarn                 | npm                     |
| ------------------------ | -------------------- | -------------------- | ----------------------- |
| å·¥ä½œç©ºé—´æ”¯æŒï¼ˆmonorepoï¼‰ | âœ”ï¸                    | âœ”ï¸                    | âœ”ï¸                       |
| éš”ç¦»çš„ `node_modules`    | âœ”ï¸ - é»˜è®¤             | âœ”ï¸                    | âœ”ï¸                       |
| æå‡çš„ `node_modules`    | âœ”ï¸                    | âœ”ï¸                    | âœ”ï¸ - é»˜è®¤                |
| Plug'n'Play              | âœ”ï¸                    | âœ”ï¸ - é»˜è®¤             | âŒ                       |
| é›¶å®‰è£…                   | âŒ                    | âœ”ï¸                    | âŒ                       |
| ä¿®è¡¥ä¾èµ–é¡¹               | âŒ                    | âœ”ï¸                    | âŒ                       |
| ç®¡ç† Node.js ç‰ˆæœ¬        | âœ”ï¸                    | âŒ                    | âŒ                       |
| æœ‰é”æ–‡ä»¶                 | âœ”ï¸ - `pnpm-lock.yaml` | âœ”ï¸ - `yarn.lock`      | âœ”ï¸ - `package-lock.json` |
| æ”¯æŒè¦†ç›–                 | âœ”ï¸                    | âœ”ï¸ - é€šè¿‡ resolutions | âœ”ï¸                       |
| å†…å®¹å¯å¯»å€å­˜å‚¨           | âœ”ï¸                    | âŒ                    | âŒ                       |
| åŠ¨æ€åŒ…æ‰§è¡Œ               | âœ”ï¸ - é€šè¿‡ `pnpm dlx`  | âœ”ï¸ - é€šè¿‡ `yarn dlx`  | âœ”ï¸ - é€šè¿‡ `npx`          |



pnpm ç›¸æ¯”äºå¦å¤–ä¸¤ä¸ªæ›´å¤§çš„åŒºåˆ«åœ¨äºï¼š



### ä¾èµ–æ ‘

pnpm é€šè¿‡ç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ã€Symbolic linkï¼‰é“¾æ¥åˆ°å…¨å±€ç¡¬ç›˜æ¥ç®¡ç† `node_modules`ã€‚å¯ä»¥å¤§å¤§å‡å°‘ç£ç›˜çš„ç©ºé—´ä½¿ç”¨é‡ï¼ŒåŒæ—¶ä¿æŒ node_modules çš„æ•´æ´ã€‚



[pnpm's strictness helps to avoid silly bugs](https://www.kochan.io/nodejs/pnpms-strictness-helps-to-avoid-silly-bugs.html)

**ä½¿ç”¨ npm å’Œ yarn æ—¶**

å®‰è£…çš„åŒ…ï¼Œä»¥ express ä¸ºä¾‹å­ï¼Œä¼šæŠŠ express  ä»¥å…¶æ‰€æœ‰å­åŒ…å…¨éƒ¨å®‰è£…åˆ° node_modules å±‚çº§ï¼ˆä¾èµ–æ˜¯å¹³é“ºçš„ï¼‰ï¼Œå› æ­¤ä½ å¯ä»¥ä½¿ç”¨è¿™äº›æ‰€æœ‰åŒ…ï¼Œå°½ç®¡ä½ æ²¡æœ‰æ˜¾ç¤ºçš„ä¾èµ–å®ƒã€‚

```
# npm / yarn çš„ node_modules ä¾èµ–ç»“æ„
- .bin
- express
- accepts
- body-parser
- ...
```

ç„¶è€Œå½“å»ä½¿ç”¨è¿™äº›æ²¡æœ‰æ˜¾ç¤ºä¾èµ–çš„åŒ…æ—¶å°±å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œä½ ä¸çŸ¥é“è¿™ä¸ªåŒ…çš„ç‰ˆæœ¬ï¼Œæ— æ³•çŸ¥é“ä»€ä¹ˆæ—¶è¢« express å‡çº§æˆ–åºŸå¼ƒã€‚



**åœ¨ä½¿ç”¨ pnpm æ—¶**

æ¬¡çº§ä¾èµ–æ˜¯ä¸ä¼šå®‰è£…åˆ° express åŒçº§çš„ï¼Œè€Œæ˜¯ä½œä¸º express çš„ä¾èµ–ï¼Œæ”¾åœ¨ .pnpm æ–‡ä»¶å¤¹ä¸‹ï¼Œå¦‚ä¸‹

```
# pnpm çš„ node_modules ä¾èµ–ç»“æ„
- .pnpm
- express
- .modules.yaml
```

![](http://file.wangsijie.top/blog/202202172118271.jpeg)



### å®‰è£…

pnpm ä¸å…è®¸å®‰è£… `package.json` ä¸­æ²¡æœ‰åŒ…å«çš„åŒ…



## å‚è€ƒ

- [JavaScript package managers compared: npm, Yarn, or pnpm?](https://blog.logrocket.com/javascript-package-managers-compared/)
- [pnpm: Feature Comparison](https://pnpm.io/feature-comparison)

- [Yarn 3.0 ğŸš€ğŸ¤– Performances, ESBuild, Better Patches, ...](https://dev.to/arcanis/yarn-3-0-performances-esbuild-better-patches-e07)
- [Yarn vs npm: Everything You Need to Know](https://www.sitepoint.com/yarn-vs-npm/)